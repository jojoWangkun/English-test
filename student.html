<!DOCTYPE html>
<meta charset="utf-8">
<title>答题入口</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/css/bootstrap.min.css">
<div class="container mt-4">
  <h1 class="text-center mb-4">开始答题</h1>
  <div id="list" class="mb-3"></div>
</div>

<script>
const GITHUB_TOKEN = "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";
const GITHUB_REPO = "jojoWangkun/English-test";

async function load(){
  const r = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/questions`,{
    headers:{Authorization:`token ${GITHUB_TOKEN}`}
  })
  const arr = r.ok?await r.json():[]
  const xs = arr.filter(i=>i.name.endsWith('.xlsx'))
  if(!xs.length){
    document.getElementById('list').innerHTML=`<div class="alert alert-warning">暂无题库</div>`
    return
  }
  document.getElementById('list').innerHTML = xs.map(i=>`
    <button class="btn btn-success w-100 mb-2" onclick="go('${i.name}')">${i.name}</button>
  `).join('')
}

function go(n){
  localStorage.setItem('currentFile',n)
  location.href='test.html'
}

window.onload=load
</script>